!function(n){"use strict";var t=n.holdup;n.holdup={noConflict:function(){return n.holdup=t,this}}}(window),!function(){"use strict";function n(){this._fulfilledBuffer=[],this._rejectedBuffer=[],this._log=!1,this._state=_,this._args=[],this._scheduled=!1}function t(n,t){return function(){return n.apply(t,arguments)}}function e(n){return n._state===_}function r(n){return n._state===v}function u(n){return n._state===y}function o(n,t,e,r){n._fulfilledBuffer.push(function(){l(n,t,v,e)}),n._rejectedBuffer.push(function(){l(n,t,y,r)})}function i(n,t,e){n._state=t?v:y,n._args=e,f(n)}function f(n){n._scheduled||(n._scheduled=!0,m(function(){n._scheduled=!1,c(n)}))}function c(n){d(r(n)?n._fulfilledBuffer:n._rejectedBuffer,null,n._args),n._fulfilledBuffer=[],n._rejectedBuffer=[]}function l(n,t,e,r){var u=n._args,o=e===v?t.fulfill:t.reject;"function"==typeof r?a(t,r,u):o.apply(t,n._args)}function a(n,t,e){var r;try{r=t.apply(null,e)}catch(u){return n.reject(u),n._log&&"undefined"!=typeof console&&console.log(u),void 0}s(n,r)}function s(n,t){var e=!1;try{e=p(t)}catch(r){return n.reject(r),n._log&&"undefined"!=typeof console&&console.log(r),void 0}e?t.then(function(){n.fulfill.apply(n,arguments)},function(){n.reject.apply(n,arguments)}):n.fulfill(t)}function p(n){return n&&"function"==typeof n.then}function d(n,t,e){var r,u;for(r=0;u=n[r];r++)u.apply(t,e)}function h(n){return Array.prototype.slice.call(n,0,n.length)}function m(n){var t=setTimeout;"undefined"!=typeof setImmediate&&(t=setImmediate),"undefined"!=typeof process&&process.nextTick&&(t=process.nextTick),t(n,0)}var g;g="undefined"!=typeof module&&module.exports&&"undefined"!=typeof require?module.exports:window.holdup;var y=-1,v=1,_=0;n.prototype.then=function(t,r){var u=new n;return o(this,u,t,r),e(this)||f(this),u.promise()},n.prototype.fulfill=function(){e(this)&&i(this,!0,h(arguments))},n.prototype.reject=function(){e(this)&&i(this,!1,h(arguments))},n.prototype.promise=function(){return{then:t(this.then,this)}},n.prototype.fulfilled=function(){return r(this)},n.prototype.rejected=function(){return u(this)},n.prototype.pending=function(){return e(this)},g.Deferred=n}(),!function(){"use strict";function n(n,t){function e(n){return function(t){l[n]=t,p.decrement()}}function u(n){return function(){l[n]=void 0,p.decrement()}}var o,f,c,l=Array(n.length),a=new s,p=r(n.length,i(a.fulfill,a),i(a.reject,a)),d=t?u:e,h=t?e:u;for(f=0,c=n.length;c>f;f++)o=n[f],o.then(d(f),h(f));return a.then(function(){return l})}function t(n,t,r){var i=[],f=[],c=function(n){i.push(n)},l=function(n){f.push(n)},a=t?u(c):o(c),s=r?u(l):o(l);return{fulfilled:i,rejected:f,promise:e(n,a,s)}}function e(n,t,e){var u,o,f,c=new s;if(0===n.length)return c.fulfill([]),c;for(f=r(n.length,i(c.fulfill,c),i(c.reject,c)),u=0;o=n[u];u++)o.then(t(f,o),e(f,o));return c}function r(n,t,e){var r=n,u=!1,o={decrement:function(){u||(r--,0===r&&t())},error:function(){u||(u=!0,e.apply(arguments))}};return 0===r&&t(),o}function u(n){return function(t,e){return function(){n&&n(e),t.decrement()}}}function o(n){return function(t,e){return function(){n&&n(e),t.error()}}}function i(n,t){return function(){n.apply(t,arguments)}}function f(n){return c(l(n))}function c(n){var t,e,r=[];for(t=0;e=n[t];t++)e instanceof Array?r=r.concat(c(e)):r.push(e);return r}function l(n,t,e){return Array.prototype.slice.call(n,t||0,e||n.length)}var a,s;"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require?(a=module.exports,s=require("./deferred").Deferred):(a=window.holdup,s=a.Deferred),a.make=function(n){var t=new s;return n(i(t.fulfill,t),i(t.reject,t)),t.promise()},a.fulfill=a.fcall=function(n){return a.make(function(t){t(n())})},a.reject=function(n){return a.make(function(t,e){e(n())})},a.all=function(){var n=t(f(arguments),!0,!1);return a.make(function(t,e){n.promise.then(function(){t(n.fulfilled)},function(){e(n.rejected[0])})})},a.none=function(){var n=t(f(arguments),!1,!0);return a.make(function(t,e){n.promise.then(function(){t(n.rejected)},function(){e(n.fulfilled[0])})})},a.resolved=a.allSettled=function(){var n=t(f(arguments),!0,!0);return a.make(function(t){n.promise.then(function(){t(n.fulfilled,n.rejected)})})},a.firstFulfilled=a.ff=function(){var n=a.none(f(arguments));return a.make(function(t,e){n.then(e,t)})},a.firstRejected=a.fr=function(){var n=a.all(f(arguments));return a.make(function(t,e){n.then(e,t)})},a.lastFulfilled=a.lf=function(){var n=a.resolved(f(arguments));return a.make(function(t,e){n.then(function(n,r){0===n.length?e(r):t(n[n.length-1])})})},a.lastRejected=a.lr=function(){var n=a.resolved(f(arguments));return a.make(function(t,e){n.then(function(n,r){0===r.length?e(n):t(r[r.length-1])})})},a.invert=function(n){return a.make(function(t,e){n.then(e,t)})},a.data=a.spread=function(){var t=l(arguments),e=f(t.slice(0,t.length-1)),r=n(e,!1),u=t[t.length-1];return r.then(function(n){u.apply(null,n)}),r},a.errors=function(){var t=l(arguments),e=f(t.slice(0,t.length-1)),r=n(e,!0),u=t[t.length-1];return r.then(function(n){u.apply(null,n)}),r},a.wait=function(n){return a.make(function(t){setTimeout(function(){t(n)},n)})},a.delay=function(n,t){return a.make(function(e,r){n.then(function(){var n=l(arguments,0);setTimeout(function(){e.apply(null,n)},t)},function(){var n=l(arguments,0);setTimeout(function(){r.apply(null,n)},t)})})},a.timeout=function(n,t){return a.make(function(e,r){setTimeout(function(){r("Error: "+t+"ms timeout exceeded.")},t),n.then(e,r)})},a.napply=function(n,t,e){var r=e.slice(0,e.length);return a.make(function(e,u){r.push(function(n,t){n?u(n):e(t)}),t.apply(n,r)})},a.nfapply=function(n,t){return a.napply(null,n,t)},a.ncall=a.wrapFor=function(n,t){var e=l(arguments,2);return a.napply(n,t,e)},a.nfcall=a.wrap=function(n){var t=l(arguments,1);return a.napply(null,n,t)},a.npost=function(n,t,e){return a.napply(n,n[t],e)},a.ninvoke=a.nsend=function(n,t){var e=l(arguments,2);return a.napply(n,n[t],e)},a.nbind=function(n,t){var e=l(arguments,2);return function(){var r=l(arguments);return a.napply(t,n,e.concat(r))}},a.nfbind=a.denodeify=function(n){var t=[n,null].concat(l(arguments,1));return a.nbind.apply(a,t)},a.nodeify=function(n,t){return n.then(function(n){t(null,n)},function(n){t(n)}),n}}();