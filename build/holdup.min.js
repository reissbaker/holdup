!function(n){"use strict";var t=n.holdup;n.holdup={noConflict:function(){return n.holdup=t,this}}}(window),!function(){"use strict";function n(n){this.then=e(n.then,n),this.error=e(n.error,n),this.thrown=e(n.thrown,n),this._deferred=n}function t(){this._fulfilledBuffer=[],this._rejectedBuffer=[],this._thrownBuffer=[],this._state=A,this._value=null,this._scheduled=!1,this._log=!1}function e(n,t){return function(){return n.apply(t,arguments)}}function r(n){return n._state===A}function u(n){return n._state===q}function o(n){return n._state===b}function f(n){return n._state===D}function i(n,t,e,r,u){n._fulfilledBuffer.push(function(n){p(t,n,q,e)}),n._rejectedBuffer.push(function(n){p(t,n,b,r)}),n._thrownBuffer.push(function(n){p(t,n,D,r)}),n._thrownBuffer.push(function(n){p(t,n,D,u)})}function c(n,t,e){n._state=t,n._value=e}function l(n){n._scheduled||(n._scheduled=!0,B(function(){n._scheduled=!1,a(n)}))}function a(n){var t=s(n);E(t,n._value),h(n)}function s(n){return u(n)?n._fulfilledBuffer:f(n)?n._thrownBuffer:n._rejectedBuffer}function h(n){n._fulfilledBuffer=[],n._rejectedBuffer=[],n._thrownBuffer=[]}function p(n,t,e,r){var u=d(n,e);"function"==typeof r?m(n,r,t):u.call(n,t)}function d(n,t){return t===q?n.fulfill:t===D?n.throwError:n.reject}function m(n,t,e){var r;try{r=t(e)}catch(u){return n.throwError(u),void 0}v(n,r)}function v(e,r){var u=null;return y(e,r),"function"==typeof r||"object"==typeof r?(u=g(r,e),"function"==typeof u?(r instanceof n?w(r._deferred,u,e):r instanceof t&&w(r,u,e),_(r,u,e)):e.fulfill(r),void 0):(e.fulfill(r),void 0)}function y(t,e){return e===t?(t.throwError(new TypeError("Promise cannot return itself.")),!0):e instanceof n&&e._deferred===t?(t.throwError(new TypeError("Promise cannot return itself")),!0):!1}function g(n,t){var e=null;try{e=k(n)}catch(r){t.throwError(r)}return e}function w(n,t,e){var r=j(n,t,e);try{t.call(n,r.resolve,r.reject,r.throwError)}catch(u){r.throwError(u)}}function _(n,t,e){var r=j(n,t,e);try{t.call(n,r.resolve,r.reject)}catch(u){r.throwError(u)}}function j(n,t,e){var r,u,o,f=!1,i=function(n){f||(f=r=!0,v(e,n))},c=function(n){f||(f=u=!0,e.reject(n))},l=function(n){f||(f=o=!0,e.throwError(n))};return{resolve:i,reject:c,throwError:l}}function k(n){return n?n.then:null}function E(n,t){var e,r;for(e=0;r=n[e];e++)r(t)}function B(n){var t=setTimeout;"undefined"!=typeof setImmediate&&(t=setImmediate),"undefined"!=typeof process&&process.nextTick&&(t=process.nextTick),t(n,0)}var T;T="undefined"!=typeof module&&module.exports&&"undefined"!=typeof require?module.exports:window.holdup;var x=function(){};"undefined"!=typeof console&&"function"==typeof console.log&&(x=function(){console.log.apply(console,arguments)});var b=0,q=1,A=2,D=3;t.prototype.then=function(e,u,o){var f=new t;return i(this,f,e,u,o),r(this)||l(this),new n(f)},t.prototype.thrown=function(n){return this.then(null,null,n)},t.prototype.error=function(n){return this.then(null,n)},t.prototype.fulfill=function(n){r(this)&&(c(this,q,n),l(this))},t.prototype.reject=function(n){r(this)&&(this._log&&x(n),c(this,b,n),l(this))},t.prototype.throwError=function(n){r(this)&&(this._log&&x(n),c(this,D,n),l(this))},t.prototype.promise=function(){return new n(this)},t.prototype.fulfilled=function(){return u(this)},t.prototype.rejected=function(){return o(this)},t.prototype.pending=function(){return r(this)},T.Deferred=t}(),!function(){"use strict";function n(n,t){function e(n){return function(t){l[n]=t,h.decrement()}}function u(n){return function(){l[n]=void 0,h.decrement()}}var o,i,c,l=Array(n.length),a=new s,h=r(n.length,f(a.fulfill,a),f(a.reject,a)),p=t?u:e,d=t?e:u;for(i=0,c=n.length;c>i;i++)o=n[i],o.then(p(i),d(i));return a.then(function(){return l})}function t(n,t,r){var f=[],i=[],c=function(n){f.push(n)},l=function(n){i.push(n)},a=t?u(c):o(c),s=r?u(l):o(l);return{fulfilled:f,rejected:i,promise:e(n,a,s)}}function e(n,t,e){var u,o,i,c=new s;if(0===n.length)return c.fulfill([]),c;for(i=r(n.length,f(c.fulfill,c),f(c.reject,c)),u=0;o=n[u];u++)o.then(t(i,o),e(i,o));return c}function r(n,t,e){var r=n,u=!1,o={decrement:function(){u||(r--,0===r&&t())},error:function(){u||(u=!0,e.apply(arguments))}};return 0===r&&t(),o}function u(n){return function(t,e){return function(){n&&n(e),t.decrement()}}}function o(n){return function(t,e){return function(){n&&n(e),t.error()}}}function f(n,t){return function(){n.apply(t,arguments)}}function i(n){return c(l(n))}function c(n){var t,e,r=[];for(t=0;e=n[t];t++)e instanceof Array?r=r.concat(c(e)):r.push(e);return r}function l(n,t,e){return Array.prototype.slice.call(n,t||0,e||n.length)}var a,s;"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require?(a=module.exports,s=require("./deferred").Deferred):(a=window.holdup,s=a.Deferred),a.make=function(n){var t=new s;return n(f(t.fulfill,t),f(t.reject,t)),t.promise()},a.fulfill=function(n){return a.make(function(t){t(n)})},a.fcall=function(n){return a.make(function(t){t(n())})},a.reject=function(n){return a.make(function(t,e){e(n)})},a.ferr=function(n){return a.make(function(t,e){e(n())})},a.all=function(){var n=t(i(arguments),!0,!1);return a.make(function(t,e){n.promise.then(function(){t(n.fulfilled)},function(){e(n.rejected[0])})})},a.none=function(){var n=t(i(arguments),!1,!0);return a.make(function(t,e){n.promise.then(function(){t(n.rejected)},function(){e(n.fulfilled[0])})})},a.resolved=a.allSettled=function(){var n=t(i(arguments),!0,!0);return a.make(function(t){n.promise.then(function(){t({fulfilled:n.fulfilled,rejected:n.rejected})})})},a.firstFulfilled=a.ff=function(){var n=a.none(i(arguments));return a.make(function(t,e){n.then(e,t)})},a.firstRejected=a.fr=function(){var n=a.all(i(arguments));return a.make(function(t,e){n.then(e,t)})},a.lastFulfilled=a.lf=function(){var n=a.resolved(i(arguments));return a.make(function(t,e){n.then(function(n){var r=n.fulfilled,u=n.rejected;0===r.length?e(u):t(r[r.length-1])})})},a.lastRejected=a.lr=function(){var n=a.resolved(i(arguments));return a.make(function(t,e){n.then(function(n){var r=n.fulfilled,u=n.rejected;0===u.length?e(r):t(u[u.length-1])})})},a.invert=function(n){return a.make(function(t,e){n.then(e,t)})},a.data=a.spread=function(){var t=l(arguments),e=i(t.slice(0,t.length-1)),r=n(e,!1),u=t[t.length-1];return r.then(function(n){u.apply(null,n)}),r},a.errors=function(){var t=l(arguments),e=i(t.slice(0,t.length-1)),r=n(e,!0),u=t[t.length-1];return r.then(function(n){u.apply(null,n)}),r},a.wait=function(n){return a.make(function(t){setTimeout(function(){t(n)},n)})},a.delay=function(n,t){return a.make(function(e,r){n.then(function(){var n=l(arguments,0);setTimeout(function(){e.apply(null,n)},t)},function(){var n=l(arguments,0);setTimeout(function(){r.apply(null,n)},t)})})},a.timeout=function(n,t){return a.make(function(e,r){setTimeout(function(){r("Error: "+t+"ms timeout exceeded.")},t),n.then(e,r)})},a.napply=function(n,t,e){var r=e.slice(0,e.length);return a.make(function(e,u){r.push(function(n,t){n?u(n):e(t)}),t.apply(n,r)})},a.nfapply=function(n,t){return a.napply(null,n,t)},a.ncall=a.wrapFor=function(n,t){var e=l(arguments,2);return a.napply(n,t,e)},a.nfcall=a.wrap=function(n){var t=l(arguments,1);return a.napply(null,n,t)},a.npost=function(n,t,e){return a.napply(n,n[t],e)},a.ninvoke=a.nsend=function(n,t){var e=l(arguments,2);return a.napply(n,n[t],e)},a.nbind=function(n,t){var e=l(arguments,2);return function(){var r=l(arguments);return a.napply(t,n,e.concat(r))}},a.nfbind=a.denodeify=function(n){var t=[n,null].concat(l(arguments,1));return a.nbind.apply(a,t)},a.nodeify=function(n,t){return n.then(function(n){t(null,n)},function(n){t(n)}),n}}();